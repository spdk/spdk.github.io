<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <!-- For Mobile Devices -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Content-Type" content="text/xhtml; charset=utf-8">
  <meta name="generator" content="Doxygen 1.8.15">
  <title>SPDK: An Overview of SPDK Applications</title>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <script type="text/javascript" src="two.min.js"></script>
  <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,900" type="text/css">
  <link href="../css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <link rel="stylesheet" href="tabs.css" type="text/css">
  <link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div class="container-fluid">
  <div id="top">  <!-- do not remove this div, it is closed by doxygen! -->
    <div class="row no-gutters">
      <div class="col-xs-12">
        <section id="nav">
          <div class="navbar navbar-default navbar-static-top banner-tabs">
            <ul class="nav navbar-nav">
              <li role="presentation">
                <a href="http://www.spdk.io/">
                  <i class="glyphicon glyphicon-home"></i>
                  <span class="box-name">home</span>
                </a>
              </li>
              <li role="presentation">
                <a href="http://www.spdk.io/releases/">
                  <i class="glyphicon glyphicon-download-alt"></i>
                  <span class="box-name">download</span>
                </a>
              </li>
              <li class="active" role="presentation">
                <a href="index.html">
                  <i class="glyphicon glyphicon-book"></i>
                  <span class="box-name">documentation</span>
                </a>
              </li>
              <li role="presentation">
                <a href="http://www.spdk.io/development/">
                  <i class="glyphicon glyphicon-wrench"></i>
                  <span class="box-name">development</span>
                </a>
              </li>
              <li role="presentation">
                <a href="https://spdk.io/ci/">
                  <i class="glyphicon glyphicon-ok"></i>
                  <span class="box-name">CI status</span>
                </a>
              </li>
              <li role="presentation">
                <a href="http://www.spdk.io/community/">
                  <i class="glyphicon glyphicon-envelope"></i>
                  <span class="box-name">community</span>
                </a>
              </li>
              <li role="presentation">
                <a href="http://www.spdk.io/blog/">
                  <i class="glyphicon glyphicon-comment"></i>
                  <span class="box-name">Blog</span>
                </a>
              </li>
              <li role="presentation">
                <a href="https://trello.com/b/MN8auadQ/spdk-roadmap">
                  <i class="glyphicon glyphicon-map-marker"></i>
                  <span class="box-name">Roadmap</span>
                </a>
              </li>
              <li role="presentation">
                <a href="http://www.spdk.io/news/">
                  <i class="glyphicon glyphicon-bullhorn"></i>
                  <span class="box-name">News</span>
                </a>
              </li>
            </ul>
          </div>
        </section>
      </div>
    </div>
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('app_overview.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">An Overview of SPDK Applications </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>SPDK is primarily a development kit that delivers libraries and header files for use in other applications. However, SPDK also contains a number of applications. These applications are primarily used to test the libraries, but many are full featured and high quality. The major applications in SPDK are:</p>
<ul>
<li><a class="el" href="iscsi.html">iSCSI Target</a></li>
<li><a class="el" href="nvmf.html">NVMe over Fabrics Target</a></li>
<li><a class="el" href="vhost.html">vhost Target</a></li>
<li>SPDK Target (a unified application combining the above three)</li>
</ul>
<p>There are also a number of tools and examples in the <code>examples</code> directory.</p>
<p>The SPDK targets are all based on a common framework so they have much in common. The framework defines a concept called a <code>subsystem</code> and all functionality is implemented in various subsystems. Subsystems have a unified initialization and teardown path.</p>
<h1><a class="anchor" id="app_config"></a>
Configuring SPDK Applications</h1>
<h2><a class="anchor" id="app_cmd_line_args"></a>
Command Line Parameters</h2>
<p>The SPDK application framework defines a set of base command line flags for all applications that use it. Specific applications may implement additional flags.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Param  </th><th class="markdownTableHeadNone">Long Param  </th><th class="markdownTableHeadNone">Type  </th><th class="markdownTableHeadNone">Default  </th><th class="markdownTableHeadNone">Description   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">-c  </td><td class="markdownTableBodyNone">&ndash;config  </td><td class="markdownTableBodyNone">string  </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"><a class="el" href="app_overview.html#cmd_arg_config_file">Configuration file</a>   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">-d  </td><td class="markdownTableBodyNone">&ndash;limit-coredump  </td><td class="markdownTableBodyNone">flag  </td><td class="markdownTableBodyNone">false  </td><td class="markdownTableBodyNone"><a class="el" href="app_overview.html#cmd_arg_limit_coredump">Limit coredump</a>   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">-e  </td><td class="markdownTableBodyNone">&ndash;tpoint-group-mask  </td><td class="markdownTableBodyNone">integer  </td><td class="markdownTableBodyNone">0x0  </td><td class="markdownTableBodyNone"><a class="el" href="app_overview.html#cmd_arg_limit_tpoint_group_mask">Tracepoint group mask</a>   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">-g  </td><td class="markdownTableBodyNone">&ndash;single-file-segments  </td><td class="markdownTableBodyNone">flag  </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"><a class="el" href="app_overview.html#cmd_arg_single_file_segments">Create just one hugetlbfs file</a>   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">-h  </td><td class="markdownTableBodyNone">&ndash;help  </td><td class="markdownTableBodyNone">flag  </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">show all available parameters and exit   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">-i  </td><td class="markdownTableBodyNone">&ndash;shm-id  </td><td class="markdownTableBodyNone">integer  </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"><a class="el" href="app_overview.html#cmd_arg_multi_process">Multi process mode</a>   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">-m  </td><td class="markdownTableBodyNone">&ndash;cpumask  </td><td class="markdownTableBodyNone">CPU mask  </td><td class="markdownTableBodyNone">0x1  </td><td class="markdownTableBodyNone">application <a class="el" href="app_overview.html#cpu_mask">CPU mask</a>   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">-n  </td><td class="markdownTableBodyNone">&ndash;mem-channels  </td><td class="markdownTableBodyNone">integer  </td><td class="markdownTableBodyNone">all channels  </td><td class="markdownTableBodyNone">number of memory channels used for DPDK   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">-p  </td><td class="markdownTableBodyNone">&ndash;main-core  </td><td class="markdownTableBodyNone">integer  </td><td class="markdownTableBodyNone">first core in CPU mask  </td><td class="markdownTableBodyNone">main (primary) core for DPDK   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">-r  </td><td class="markdownTableBodyNone">&ndash;rpc-socket  </td><td class="markdownTableBodyNone">string  </td><td class="markdownTableBodyNone">/var/tmp/spdk.sock  </td><td class="markdownTableBodyNone">RPC listen address   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">-s  </td><td class="markdownTableBodyNone">&ndash;mem-size  </td><td class="markdownTableBodyNone">integer  </td><td class="markdownTableBodyNone">all hugepage memory  </td><td class="markdownTableBodyNone"><a class="el" href="app_overview.html#cmd_arg_memory_size">Memory size</a>   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">&ndash;silence-noticelog  </td><td class="markdownTableBodyNone">flag  </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">disable notice level logging to <code>stderr</code>   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">-u  </td><td class="markdownTableBodyNone">&ndash;no-pci  </td><td class="markdownTableBodyNone">flag  </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"><a class="el" href="app_overview.html#cmd_arg_disable_pci_access">Disable PCI access</a>.   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">&ndash;wait-for-rpc  </td><td class="markdownTableBodyNone">flag  </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"><a class="el" href="app_overview.html#cmd_arg_deferred_initialization">Deferred initialization</a>   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">-B  </td><td class="markdownTableBodyNone">&ndash;pci-blocked  </td><td class="markdownTableBodyNone">B:D:F  </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"><a class="el" href="app_overview.html#cmd_arg_pci_blocked_allowed">PCI address blocked and allowed lists</a>.   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">-A  </td><td class="markdownTableBodyNone">&ndash;pci-allowed  </td><td class="markdownTableBodyNone">B:D:F  </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"><a class="el" href="app_overview.html#cmd_arg_pci_blocked_allowed">PCI address blocked and allowed lists</a>.   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">-R  </td><td class="markdownTableBodyNone">&ndash;huge-unlink  </td><td class="markdownTableBodyNone">flag  </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"><a class="el" href="app_overview.html#cmd_arg_huge_unlink">Unlink hugepage files after initialization</a>   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">&ndash;huge-dir  </td><td class="markdownTableBodyNone">string  </td><td class="markdownTableBodyNone">the first discovered  </td><td class="markdownTableBodyNone">allocate hugepages from a specific mount   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">-L  </td><td class="markdownTableBodyNone">&ndash;logflag  </td><td class="markdownTableBodyNone">string  </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"><a class="el" href="app_overview.html#cmd_arg_log_flags">Log flag</a>   </td></tr>
</table>
<h3><a class="anchor" id="cmd_arg_config_file"></a>
Configuration file</h3>
<p>SPDK applications are configured using a JSON RPC configuration file. See <a class="el" href="jsonrpc.html">JSON-RPC Methods</a> for details.</p>
<h3><a class="anchor" id="cmd_arg_limit_coredump"></a>
Limit coredump</h3>
<p>By default, an SPDK application will set resource limits for core file sizes to RLIM_INFINITY. Specifying <code>--limit-coredump</code> will not set the resource limits.</p>
<h3><a class="anchor" id="cmd_arg_limit_tpoint_group_mask"></a>
Tracepoint group mask</h3>
<p>SPDK has an experimental low overhead tracing framework. Tracepoints in this framework are organized into tracepoint groups. By default, all tracepoint groups are disabled. <code>--tpoint-group-mask</code> can be used to enable a specific subset of tracepoint groups in the application.</p>
<p>Note: Additional documentation on the tracepoint framework is in progress.</p>
<h3><a class="anchor" id="cmd_arg_deferred_initialization"></a>
Deferred initialization</h3>
<p>SPDK applications progress through a set of states beginning with <code>STARTUP</code> and ending with <code>RUNTIME</code>.</p>
<p>If the <code>--wait-for-rpc</code> parameter is provided SPDK will pause just before starting framework initialization. This state is called <code>STARTUP</code>. The JSON RPC server is ready but only a small subset of commands are available to set up initialization parameters. Those parameters can't be changed after the SPDK application enters <code>RUNTIME</code> state. When the client finishes configuring the SPDK subsystems it needs to issue the <a class="el" href="jsonrpc.html#rpc_framework_start_init">framework_start_init</a> RPC command to begin the initialization process. After <code>rpc_framework_start_init</code> returns <code>true</code> SPDK will enter the <code>RUNTIME</code> state and the list of available commands becomes much larger.</p>
<p>To see which RPC methods are available in the current state, issue the <code>rpc_get_methods</code> with the parameter <code>current</code> set to <code>true</code>.</p>
<p>For more details see <a class="el" href="jsonrpc.html">JSON-RPC Methods</a> documentation.</p>
<h3><a class="anchor" id="cmd_arg_single_file_segments"></a>
Create just one hugetlbfs file</h3>
<p>Instead of creating one hugetlbfs file per page, this option makes SPDK create one file per hugepages per socket. This is needed for <a class="el" href="virtio.html">Virtio driver</a> to be used with more than 8 hugepages. See <a class="el" href="virtio.html#virtio_2mb">2MB hugepages</a>.</p>
<h3><a class="anchor" id="cmd_arg_multi_process"></a>
Multi process mode</h3>
<p>When <code>--shm-id</code> is specified, the application is started in multi-process mode. Applications using the same shm-id share their memory and <a class="el" href="nvme.html#nvme_multi_process">NVMe devices</a>. The first app to start with a given id becomes a primary process, with the rest, called secondary processes, only attaching to it. When the primary process exits, the secondary ones continue to operate, but no new processes can be attached at this point. All processes within the same shm-id group must use the same <a class="el" href="app_overview.html#cmd_arg_single_file_segments">--single-file-segments setting</a>.</p>
<h3><a class="anchor" id="cmd_arg_memory_size"></a>
Memory size</h3>
<p>Total size of the hugepage memory to reserve. If DPDK env layer is used, it will reserve memory from all available hugetlbfs mounts, starting with the one with the highest page size. This option accepts a number of bytes with a possible binary prefix, e.g. 1024, 1024M, 1G. The default unit is megabyte.</p>
<p>Starting with DPDK 18.05.1, it's possible to reserve hugepages at runtime, meaning that SPDK application can be started with 0 pre-reserved memory. Unlike hugepages pre-reserved at the application startup, the hugepages reserved at runtime will be released to the system as soon as they're no longer used.</p>
<h3><a class="anchor" id="cmd_arg_disable_pci_access"></a>
Disable PCI access</h3>
<p>If SPDK is run with PCI access disabled it won't detect any PCI devices. This includes primarily NVMe and IOAT devices. Also, the VFIO and UIO kernel modules are not required in this mode.</p>
<h3><a class="anchor" id="cmd_arg_pci_blocked_allowed"></a>
PCI address blocked and allowed lists</h3>
<p>If blocked list is used, then all devices with the provided PCI address will be ignored. If an allowed list is used, only allowed devices will be probed. <code>-B</code> or <code>-A</code> can be used more than once, but cannot be mixed together. That is, <code>-B</code> and <code>-A</code> cannot be used at the same time.</p>
<h3><a class="anchor" id="cmd_arg_huge_unlink"></a>
Unlink hugepage files after initialization</h3>
<p>By default, each DPDK-based application tries to remove any orphaned hugetlbfs files during its initialization. This option removes hugetlbfs files of the current process as soon as they're created, but is not compatible with <code>--shm-id</code>.</p>
<h3><a class="anchor" id="cmd_arg_log_flags"></a>
Log flag</h3>
<p>Enable a specific log type. This option can be used more than once. A list of all available types is provided in the <code>--help</code> output, with <code>--logflag all</code> enabling all of them. Additionally enables debug print level in debug builds of SPDK.</p>
<h2><a class="anchor" id="cpu_mask"></a>
CPU mask</h2>
<p>Whenever the <code>CPU mask</code> is mentioned it is a string in one of the following formats:</p>
<ul>
<li>Case insensitive hexadecimal string with or without "0x" prefix.</li>
<li>Comma separated list of CPUs or list of CPU ranges. Use '-' to define range.</li>
</ul>
<h3>Example</h3>
<p>The following CPU masks are equal and correspond to CPUs 0, 1, 2, 8, 9, 10, 11 and 12:</p>
<div class="fragment"><div class="line">0x1f07</div><div class="line">0x1F07</div><div class="line">1f07</div><div class="line">[0,1,2,8-12]</div><div class="line">[0, 1, 2, 8, 9, 10, 11, 12]</div></div><!-- fragment --> </div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
</div>
