<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="generator" content="Doxygen 1.9.1" />
  <title>SPDK: bdevperf</title>
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
  <script type="text/javascript" src="../js/doxyboot.js"></script>
  <script type="text/javascript" src="./navtree.js"></script>
  <link href="../css/bootstrap.min.css" rel="stylesheet" type="text/css">
  <link href="../css/spdk.css" rel="stylesheet" type="text/css">
</head>
<body>
  <nav class="navbar navbar-expand-md navbar-dark bg-dark px-2">
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <a class="navbar-brand" href="/" aria-label="SPDK">
      <img src="/img/spdk.svg"  width="36" height="36" alt="Storage Performance Development Kit" />
    </a>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <div class="navbar-nav mr-auto">
        <a class="nav-link header-link active" href="../doc/">Documentation</a>
        <a class="nav-link header-link" href="../development/">Development</a>
        <a class="nav-link header-link" href="../community/">Community</a>
        <a class="nav-link header-link" href="../blog/">Blog</a>
      </div>
      <div class="navbar-nav ml-auto mr-3">
        <a class="nav-link header-link" href="https://github.com/spdk/spdk">
          <svg xmlns="http://www.w3.org/2000/svg" class="navbar-nav-svg"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
        </a>
      </div>
    </div>
  </nav>
  <div class="container-fluid doc">
      <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('bdevperf.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">bdevperf </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_bdevperf"></a> </p><h1>Introduction</h1>
<p>bdevperf is an SPDK application used for performance testing of block devices (bdevs) exposed by the SPDK bdev layer. It is an alternative to the SPDK bdev fio plugin for benchmarking SPDK bdevs. In some cases, bdevperf can provide lower overhead than the fio plugin, resulting in better performance and efficiency for tests using a limited number of CPU cores.</p>
<p>bdevperf exposes command line interface that allows to specify SPDK framework options as well as testing options. bdevperf also supports a configuration file format similar to FIO. It allows user to create jobs parameterized by filename, cpumask, blocksize, queuesize, etc.</p>
<h1>Config file</h1>
<p>bdevperf's config file format is similar to FIO.</p>
<p>Below is an example config file that uses all available parameters:</p>
<div class="fragment"><div class="line">[global]</div>
<div class="line">filename=Malloc0:Malloc1</div>
<div class="line">bs=1024</div>
<div class="line">iosize=256</div>
<div class="line">rw=randrw</div>
<div class="line">rwmixread=90</div>
<div class="line"> </div>
<div class="line">[A]</div>
<div class="line">cpumask=0xff</div>
<div class="line"> </div>
<div class="line">[B]</div>
<div class="line">cpumask=[0-128]</div>
<div class="line">filename=Malloc1</div>
<div class="line"> </div>
<div class="line">[global]</div>
<div class="line">filename=Malloc0</div>
<div class="line">rw=write</div>
<div class="line"> </div>
<div class="line">[C]</div>
<div class="line">bs=4096</div>
<div class="line">iosize=128</div>
<div class="line">offset=1000000</div>
<div class="line">length=1000000</div>
</div><!-- fragment --><p>Jobs <code>[A]</code> <code>[B]</code> or <code>[C]</code>, inherit default values from <code>[global]</code> section residing above them. So in the example, job <code>[A]</code> inherits <code>filename</code> value and uses both <code>Malloc0</code> and <code>Malloc1</code> bdevs as targets, job <code>[B]</code> overrides its <code>filename</code> value and uses <code>Malloc1</code> and job <code>[C]</code> inherits value <code>Malloc0</code> for its <code>filename</code>.</p>
<p>Interaction with CLI arguments is not the same as in FIO however. If bdevperf receives CLI argument, it overrides values of corresponding parameter for all <code>[global]</code> sections of config file. So if example config is used, specifying <code>-q</code> argument will make jobs <code>[A]</code> and <code>[B]</code> use its value.</p>
<p>Below is a full list of supported parameters with descriptions.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Param   </th><th class="markdownTableHeadNone">Default   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">filename   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Bdevs to use, separated by ":"    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">cpumask   </td><td class="markdownTableBodyNone">Maximum available   </td><td class="markdownTableBodyNone">CPU mask. Format is defined at <a class="el" href="app_overview.html#cpu_mask">CPU mask</a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">bs   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Block size (io size)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">iodepth   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Queue depth    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">rwmixread   </td><td class="markdownTableBodyNone"><code>50</code>   </td><td class="markdownTableBodyNone">Percentage of a mixed workload that should be reads    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">offset   </td><td class="markdownTableBodyNone"><code>0</code>   </td><td class="markdownTableBodyNone">Start I/O at the provided offset on the bdev    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">length   </td><td class="markdownTableBodyNone">100% of bdev size   </td><td class="markdownTableBodyNone">End I/O at <code>offset</code>+<code>length</code> on the bdev    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">rw   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Type of I/O pattern   </td></tr>
</table>
<p>Available rw types:</p>
<ul>
<li>read</li>
<li>randread</li>
<li>write</li>
<li>randwrite</li>
<li>verify</li>
<li>reset</li>
<li>unmap</li>
<li>write_zeroes</li>
<li>flush</li>
<li>rw</li>
<li>randrw </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
<ul>
        <li class="footer">Generated by
        <a href="http://www.doxygen.org/index.html">doxygen</a> 1.9.1 </li>
</ul>
</div>
</div>
</body>
</html>
