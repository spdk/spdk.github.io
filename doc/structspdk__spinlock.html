<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="generator" content="Doxygen 1.9.1" />
  <title>SPDK: spdk_spinlock Struct Reference</title>
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
  <script type="text/javascript" src="../js/doxyboot.js"></script>
  <script type="text/javascript" src="./navtree.js"></script>
  <link href="../css/bootstrap.min.css" rel="stylesheet" type="text/css">
  <link href="../css/spdk.css" rel="stylesheet" type="text/css">
</head>
<body>
  <nav class="navbar navbar-expand-md navbar-dark bg-dark px-2">
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <a class="navbar-brand" href="/" aria-label="SPDK">
      <img src="/img/spdk.svg"  width="36" height="36" alt="Storage Performance Development Kit" />
    </a>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <div class="navbar-nav me-auto">
        <a class="nav-link header-link active" href="../doc/">Documentation</a>
        <a class="nav-link header-link" href="../development/">Development</a>
        <a class="nav-link header-link" href="../community/">Community</a>
        <a class="nav-link header-link" href="../blog/">Blog</a>
      </div>
      <div class="navbar-nav ms-auto me-3">
        <a class="nav-link header-link" href="https://github.com/spdk/spdk">
          <svg xmlns="http://www.w3.org/2000/svg" class="navbar-nav-svg"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
        </a>
      </div>
    </div>
  </nav>
  <div class="container-fluid doc">
      <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('structspdk__spinlock.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-attribs">Data Fields</a>  </div>
  <div class="headertitle">
<div class="title">spdk_spinlock Struct Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>A spinlock augmented with safety checks for use with SPDK.  
 <a href="structspdk__spinlock.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Data Fields</h2></td></tr>
<tr class="memitem:a8341e5c9f9182542b58344429c216dd7"><td class="memItemLeft" align="right" valign="top"><a id="a8341e5c9f9182542b58344429c216dd7"></a>
pthread_spinlock_t&#160;</td><td class="memItemRight" valign="bottom"><b>spinlock</b></td></tr>
<tr class="separator:a8341e5c9f9182542b58344429c216dd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0acb59dc868eba185fcccfa4b9e27997"><td class="memItemLeft" align="right" valign="top"><a id="a0acb59dc868eba185fcccfa4b9e27997"></a>
struct spdk_thread *&#160;</td><td class="memItemRight" valign="bottom"><b>thread</b></td></tr>
<tr class="separator:a0acb59dc868eba185fcccfa4b9e27997"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6080d61295d3ec874929606a7add1a65"><td class="memItemLeft" align="right" valign="top"><a id="a6080d61295d3ec874929606a7add1a65"></a>
struct spdk_spinlock_internal *&#160;</td><td class="memItemRight" valign="bottom"><b>internal</b></td></tr>
<tr class="separator:a6080d61295d3ec874929606a7add1a65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa29470f9663502cade3261f66a21ad1e"><td class="memItemLeft" align="right" valign="top"><a id="aa29470f9663502cade3261f66a21ad1e"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>initialized</b></td></tr>
<tr class="separator:aa29470f9663502cade3261f66a21ad1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36f6f1fb9f6148c3c1075b983c2fb155"><td class="memItemLeft" align="right" valign="top"><a id="a36f6f1fb9f6148c3c1075b983c2fb155"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>destroyed</b></td></tr>
<tr class="separator:a36f6f1fb9f6148c3c1075b983c2fb155"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A spinlock augmented with safety checks for use with SPDK. </p>
<p>SPDK code that uses <a class="el" href="structspdk__spinlock.html" title="A spinlock augmented with safety checks for use with SPDK.">spdk_spinlock</a> runs from an SPDK thread, which itself is associated with a pthread. There are typically many SPDK threads associated with each pthread. The SPDK application may migrate SPDK threads between pthreads from time to time to balance the load on those threads. Migration of SPDK threads only happens when the thread is off CPU, and as such it is only safe to hold a lock so long as an SPDK thread stays on CPU.</p>
<p>It is not safe to lock a spinlock, return from the event or poller, then unlock it at some later time because:</p>
<ul>
<li>Even though the SPDK thread may be the same, the SPDK thread may be running on different pthreads during lock and unlock. A pthread spinlock may consider this to be an unlock by a non-owner, which results in undefined behavior.</li>
<li>A lock that is acquired by a poller or event may be needed by another poller or event that runs on the same pthread. This can lead to deadlock or detection of deadlock.</li>
<li>A lock that is acquired by a poller or event that is needed by another poller or event that runs on a second pthread will block the second pthread from doing any useful work until the lock is released. Because the lock holder and the lock acquirer are on the same pthread, this would lead to deadlock.</li>
</ul>
<p>If an SPDK spinlock is used erroneously, the program will abort. </p>
</div><hr/>The documentation for this struct was generated from the following file:<ul>
<li><a class="el" href="thread_8h.html">thread.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
<ul>
        <li class="footer">Generated by
        <a href="http://www.doxygen.org/index.html">doxygen</a> 1.9.1 </li>
</ul>
</div>
</div>
</body>
</html>
